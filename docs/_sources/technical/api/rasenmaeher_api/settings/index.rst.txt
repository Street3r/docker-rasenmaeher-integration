:py:mod:`rasenmaeher_api.settings`
==================================

.. py:module:: rasenmaeher_api.settings

.. autoapi-nested-parse::

   Application settings. 



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   rasenmaeher_api.settings.LogLevel
   rasenmaeher_api.settings.Settings




Attributes
~~~~~~~~~~

.. autoapisummary::

   rasenmaeher_api.settings.TEMP_DIR
   rasenmaeher_api.settings.LOGGER
   rasenmaeher_api.settings.settings


.. py:data:: TEMP_DIR

   

.. py:data:: LOGGER

   

.. py:class:: LogLevel


   Bases: :py:obj:`str`, :py:obj:`enum.Enum`

   Possible log levels.

   .. py:attribute:: NOTSET
      :value: 'NOTSET'

      

   .. py:attribute:: DEBUG
      :value: 'DEBUG'

      

   .. py:attribute:: INFO
      :value: 'INFO'

      

   .. py:attribute:: WARNING
      :value: 'WARNING'

      

   .. py:attribute:: ERROR
      :value: 'ERROR'

      

   .. py:attribute:: FATAL
      :value: 'FATAL'

      


.. py:class:: Settings


   Bases: :py:obj:`pydantic.BaseSettings`

   Application settings.

   These parameters can be configured
   with environment variables.

   .. py:class:: Config


      Configuration of settings.

      .. py:attribute:: env_file
         :value: '.env'

         

      .. py:attribute:: env_prefix
         :value: 'RM_'

         

      .. py:attribute:: env_file_encoding
         :value: 'utf-8'

         


   .. py:attribute:: host
      :type: str
      :value: '127.0.0.1'

      

   .. py:attribute:: port
      :type: int
      :value: 8000

      

   .. py:attribute:: workers_count
      :type: int
      :value: 1

      

   .. py:attribute:: reload
      :type: bool
      :value: True

      

   .. py:attribute:: environment
      :type: str
      :value: 'dev'

      

   .. py:attribute:: log_level
      :type: LogLevel

      

   .. py:attribute:: log_level_int
      :type: int

      

   .. py:attribute:: integration_api_port
      :type: int
      :value: 4625

      

   .. py:attribute:: kraftwerk_manifest_path
      :type: str
      :value: '/pvarki/kraftwerk-rasenmaeher-init.json'

      

   .. py:attribute:: kraftwerk_manifest_bool
      :type: bool
      :value: False

      

   .. py:attribute:: kraftwerk_manifest_dict
      :type: Dict[Any, Any]

      

   .. py:attribute:: api_client_cert_header
      :type: str
      :value: 'X-ClientCert-DN'

      

   .. py:attribute:: test_api_client_cert_header_value
      :type: str
      :value: 'CN=fake.localmaeher.pvarki.fi,O=N/A'

      

   .. py:attribute:: api_healthcheck_proto
      :type: str
      :value: 'http://'

      

   .. py:attribute:: api_healthcheck_url
      :type: str
      :value: '/api/v1/healthcheck'

      

   .. py:attribute:: api_healthcheck_headers
      :type: str
      :value: '{"propably":"not_needed"}'

      

   .. py:attribute:: sentry_dsn
      :type: Optional[str]

      

   .. py:attribute:: sentry_sample_rate
      :type: float
      :value: 1.0

      

   .. py:attribute:: cfssl_host
      :type: str
      :value: 'http://127.0.0.1'

      

   .. py:attribute:: cfssl_port
      :type: str
      :value: '8888'

      

   .. py:attribute:: mtls_client_cert_path
      :value: '/data/persistent/rmmtlsclient.pem'

      

   .. py:attribute:: mtls_client_key_path
      :value: '/data/persistent/rmmtlsclient.key'

      

   .. py:attribute:: mtls_client_cert_cn
      :value: 'rasenmaeher'

      

   .. py:attribute:: keycloak_server_url
      :type: Optional[str]

      

   .. py:attribute:: keycloak_client_id
      :type: Optional[str]

      

   .. py:attribute:: keycloak_realm_name
      :type: Optional[str]

      

   .. py:attribute:: keycloak_client_secret
      :type: Optional[str]

      

   .. py:attribute:: ldap_conn_string
      :type: Optional[str]

      

   .. py:attribute:: ldap_username
      :type: Optional[str]

      

   .. py:attribute:: ldap_client_secret
      :type: Optional[str]

      

   .. py:attribute:: sqlite_init_management_hash
      :type: str
      :value: 'PaulinTaikaKaulinOnKaunis_PaulisMagicPinIsBuuutiful!11!1'

      

   .. py:attribute:: sqlite_first_time_user_hash
      :type: str
      :value: 'PerPerPerjantaiPulloParisee'

      

   .. py:attribute:: one_time_admin_code
      :type: str
      :value: 'HackHackHacatoneillaOnPorakoiraNukkumassa'

      

   .. py:attribute:: sqlite_filepath_prod
      :type: str
      :value: '/data/persistent/sqlite/rm_db.sql'

      

   .. py:attribute:: sqlite_filepath_dev
      :type: str
      :value: '/tmp/rm_db.sql'

      

   .. py:attribute:: sqlite_enrollement_table_schema
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ CREATE TABLE IF NOT EXISTS enrollment (
                                                   id integer PRIMARY KEY AUTOINCREMENT,
                                                   work_id text NOT NULL,
                                                   work_id_hash text NOT NULL,
                                                   state text NOT NULL,
                                                   accepted text NOT NULL,
                                                   cert_dl_link text NOT NULL,
                                                   cert_howto_dl_link text NOT NULL,
                                                   mtls_test_link text NOT NULL,
                                                   verification_code text NOT NULL,
                                                   locked text NOT NULL,
                                                   UNIQUE(work_id)
                                               ); """

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_management_table_schema
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ CREATE TABLE IF NOT EXISTS management (
                                                   id integer PRIMARY KEY AUTOINCREMENT,
                                                   management_hash text NOT NULL,
                                                   special_rules text NOT NULL,
                                                   active INT NOT NULL CHECK (active IN (0, 1)),
                                                   UNIQUE(management_hash)
                                               ); """

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_services_table_schema
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ CREATE TABLE IF NOT EXISTS services (
                                                   id integer PRIMARY KEY AUTOINCREMENT,
                                                   service_name text NOT NULL,
                                                   init_state text NOT NULL,
                                                   endpoint_proto_host_port text NOT NULL,
                                                   healthcheck_url text NOT NULL,
                                                   healthcheck_headers text NOT NULL,
                                                   UNIQUE(service_name)
                                               ); """

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_jwt_table_schema
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """CREATE TABLE IF NOT EXISTS jwt (
                                               id integer PRIMARY KEY AUTOINCREMENT,
                                               claims text NOT NULL,
                                               consumed text NOT NULL,
                                               work_id_hash text NOT NULL,
                                               work_id text NOT NULL,
                                               exchange_code text NOT NULL
                                           ); """

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_insert_into_services
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ INSERT OR REPLACE INTO services
                                                   (service_name,
                                                   init_state,
                                                   endpoint_proto_host_port,
                                                   healthcheck_url,
                                                   healthcheck_headers
                                                   )
                                                   VALUES(
                                                       '{service_name}',
                                                       '{init_state}',
                                                       '{endpoint_proto_host_port}',
                                                       '{healthcheck_url}',
                                                       '{healthcheck_headers}'
                                                   )
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_services
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT service_name, init_state, endpoint_proto_host_port,
                                                    healthcheck_url, healthcheck_headers
                                               FROM services
                                           ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_insert_into_enrollment
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ INSERT INTO enrollment
                                                   (work_id, work_id_hash, state, accepted, cert_dl_link, cert_howto_dl_link, mtls_test_link, verification_code, locked)
                                                   VALUES(
                                                   '{work_id}','{work_id_hash}','{state}', '{accepted}', '{cert_dl_link}',
                                                   '{cert_howto_dl_link}', '{mtls_test_link}', '{verification_code}','{locked}'
                                                   )
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_insert_into_management
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ INSERT OR REPLACE INTO management
                                                   (management_hash, special_rules, active)
                                                   VALUES('{management_hash}','{special_rules}','{active}')
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_insert_into_jwt
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """ INSERT INTO jwt
                                               (claims, consumed, work_id_hash, work_id, exchange_code)
                                               VALUES('{claims}','{consumed}','{work_id_hash}','{work_id}','{exchange_code}')
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_enrollment
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT
               work_id, work_id_hash, state, accepted, cert_dl_link, cert_howto_dl_link, mtls_test_link, verification_code, locked
                                                   FROM enrollment
                                                   WHERE work_id='{work_id}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_enrollment_all
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT
               work_id, work_id_hash, state, accepted, cert_dl_link, cert_howto_dl_link, mtls_test_link, verification_code, locked
                                                   FROM enrollment
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_enrollment_where_hash
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT
               work_id, work_id_hash, state, accepted, cert_dl_link, cert_howto_dl_link, mtls_test_link, verification_code, locked
                                                   FROM enrollment
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_management
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT management_hash, special_rules, active FROM management
                                                   WHERE management_hash='{management_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_management_where_hash_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT management_hash, special_rules, active FROM management
                                               WHERE management_hash LIKE '%{management_hash}%'
                                           ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_management_where_hash_and_special_rule_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   SELECT management_hash, special_rules, active FROM management
                                                   WHERE special_rules LIKE '%{special_rules}%'
                                                   AND management_hash='{management_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_management_where_hash_like_and_special_rule
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   SELECT management_hash, special_rules, active FROM management
                                                   WHERE special_rules='{special_rules}'
                                                   AND management_hash LIKE '%{management_hash}%'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_management_where_special_rule_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   SELECT management_hash, special_rules, active FROM management
                                                   WHERE special_rules LIKE '%{special_rules}%'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_sel_from_enrollment_where_verification_code
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT work_id_hash
                                                   FROM enrollment
                                                   WHERE verification_code='{verification_code}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_del_from_management_where_special_rule_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   DELETE FROM management
                                                   WHERE special_rules LIKE '%{special_rules}%'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_from_management_where_special_rule_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   UPDATE management
                                                   SET special_rules='{new_special_rules}'
                                                   WHERE special_rules LIKE '{special_rules}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_from_management_where_management_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   UPDATE management
                                                   SET management_hash='{new_management_hash}'
                                                   WHERE special_rules='{special_rules}'
                                                   AND management_hash LIKE '{management_hash}_%'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_del_from_management_where_hash
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   DELETE FROM management
                                                   WHERE management_hash='{management_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_del_from_management_where_hash_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """
                                                   DELETE FROM management
                                                   WHERE management_hash LIKE '%{management_hash}%'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_del_from_enrollment_where_hash
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """DELETE FROM enrollment
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_management_rules
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE management
                                                   SET special_rules='{special_rules}'
                                                   WHERE work_id_hash='{management_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_management_state
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE management
                                               SET active = '{active}'
                                               WHERE management_hash = '{management_hash}'
                                               AND special_rules = '{special_rules}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: update_management_hash_like
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE management
                                           SET active = '{active}'
                                           WHERE management_hash LIKE '%{management_hash}%'
                                           AND special_rules = '{special_rules}'
                                           ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_accept_enrollment
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET accepted='{management_hash}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_cert_dl_link
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET cert_dl_link='{cert_download_link}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_cert_howto_dl_link
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET cert_howto_dl_link='{howto_download_link}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_mtls_test_link
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET mtls_test_link='{mtls_test_link}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_mtls_test_link_all
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET mtls_test_link='{mtls_test_link}'
                                                   WHERE work_id_hash IS NOT NULL
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_state
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET state='{state}'
                                                   WHERE work_id_hash='{work_id_hash}' OR work_id='{work_id}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_verification_code
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET verification_code='{verification_code}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_update_enrollment_locked_state
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE enrollment
                                                   SET locked='{locked}'
                                                   WHERE work_id_hash='{work_id_hash}'
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_healtcheck_query
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT id
                                                   FROM management
                                                   LIMIT 2
                                               ;"""

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_jwt_sel_from_jwt_where_exchange
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """SELECT id, claims, consumed, work_id_hash, work_id, exchange_code
                                                   FROM jwt
                                                   WHERE exchange_code='{exchange_code}'
                                               """

       .. raw:: html

           </details>

      

   .. py:attribute:: sqlite_jwt_update_consumed_where_exchange
      :value: Multiline-String

       .. raw:: html

           <details><summary>Show Value</summary>

       .. code-block:: python

           """UPDATE jwt
                                                   SET consumed='{new_consumed_state}'
                                                   WHERE exchange_code='{exchange_code}'
                                               """

       .. raw:: html

           </details>

      


.. py:data:: settings

   

