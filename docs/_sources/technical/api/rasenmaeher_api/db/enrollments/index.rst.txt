:py:mod:`rasenmaeher_api.db.enrollments`
========================================

.. py:module:: rasenmaeher_api.db.enrollments

.. autoapi-nested-parse::

   Abstractions for enrollments



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   rasenmaeher_api.db.enrollments.EnrollmentPool
   rasenmaeher_api.db.enrollments.EnrollmentState
   rasenmaeher_api.db.enrollments.Enrollment




Attributes
~~~~~~~~~~

.. autoapisummary::

   rasenmaeher_api.db.enrollments.LOGGER
   rasenmaeher_api.db.enrollments.CODE_CHAR_COUNT
   rasenmaeher_api.db.enrollments.CODE_ALPHABET
   rasenmaeher_api.db.enrollments.CODE_MAX_ATTEMPTS


.. py:data:: LOGGER

   

.. py:data:: CODE_CHAR_COUNT
   :value: 8

   

.. py:data:: CODE_ALPHABET

   

.. py:data:: CODE_MAX_ATTEMPTS
   :value: 100

   

.. py:class:: EnrollmentPool


   Bases: :py:obj:`rasenmaeher_api.db.base.ORMBaseModel`

   Enrollment pools aka links, pk is UUID and comes from basemodel

   .. py:attribute:: __tablename__
      :value: 'enrollmentpools'

      

   .. py:attribute:: owner

      

   .. py:attribute:: active

      

   .. py:attribute:: extra

      

   .. py:attribute:: invitecode

      

   .. py:method:: by_pk_or_invitecode(inval, allow_deleted = False)
      :classmethod:
      :async:

      Get pool by pk or by invitecode


   .. py:method:: create_enrollment(callsign)
      :async:

      Create enrollment from this pool


   .. py:method:: set_active(state)
      :async:

      Set active and return refreshed object


   .. py:method:: list(by_owner = None, include_deleted = False)
      :classmethod:
      :async:

      List pools, optionally by owner or including deleted pools


   .. py:method:: _generate_unused_code()
      :classmethod:
      :async:

      Internal helper to generate a code that is free
      NOTE: This MUST ONLY be used inside a transaction for nothing is guaranteed


   .. py:method:: create_for_owner(person, extra = None)
      :classmethod:
      :async:

      Creates one for given owner


   .. py:method:: reset_invitecode()
      :async:

      Reset invitecode


   .. py:method:: by_invitecode(invitecode, allow_deleted = False)
      :classmethod:
      :async:

      Get by invitecode



.. py:class:: EnrollmentState


   Bases: :py:obj:`enum.IntEnum`

   Enrollment states

   .. py:attribute:: PENDING
      :value: 0

      

   .. py:attribute:: APPROVED
      :value: 1

      

   .. py:attribute:: REJECTED
      :value: 2

      


.. py:class:: Enrollment


   Bases: :py:obj:`rasenmaeher_api.db.base.ORMBaseModel`

   Enrollments, pk is UUID and comes from basemodel

   .. py:attribute:: __tablename__
      :value: 'enrollments'

      

   .. py:attribute:: approvecode

      

   .. py:attribute:: callsign

      

   .. py:attribute:: decided_on

      

   .. py:attribute:: decided_by

      

   .. py:attribute:: person

      

   .. py:attribute:: pool

      

   .. py:attribute:: state

      

   .. py:attribute:: extra

      

   .. py:method:: by_pk_or_callsign(inval)
      :classmethod:
      :async:

      Get enrollment by pk or by callsign


   .. py:method:: approve(approver)
      :async:

      Creates the person record, their certs etc


   .. py:method:: reject(decider)
      :async:

      Reject


   .. py:method:: list(by_pool = None)
      :classmethod:
      :async:

      List enrollments, optionally by pool (enrollment deletion is not allowed, they can only be rejected)


   .. py:method:: by_callsign(callsign)
      :classmethod:
      :async:

      Get by callsign


   .. py:method:: by_approvecode(code)
      :classmethod:
      :async:

      Get by approvecode


   .. py:method:: reset_approvecode4callsign(callsign)
      :classmethod:
      :async:

      Reset approvecode code for callsign


   .. py:method:: reset_approvecode()
      :async:

      Reset approvecode


   .. py:method:: _generate_unused_code()
      :classmethod:
      :async:

      Internal helper to generate a code that is free
      NOTE: This MUST ONLY be used inside a transaction for nothing is guaranteed


   .. py:method:: create_for_callsign(callsign, pool = None, extra = None)
      :classmethod:
      :async:

      Create a new one with random code for the callsign


   .. py:method:: delete()
      :async:

      Deletion of enrollments is not allowed



